#!name = 七猫小说去广告
#!desc = [配合越狱插件使用]去除热门和图书中的横幅广告、底栏书城红点标识，精简图书标签和我的页面，提供自定义伪装和精简功能。仅在7.62.20版本下测试。
#!author = nathalie[https://github.com/Nathalie-Annis]
#!homepage = https://github.com/Nathalie-Annis/Loon/
#!icon = https://raw.githubusercontent.com/Nathalie-Annis/Loon/refs/heads/main/Icon/qimao.png

[Argument]
hideCoin=switch,false,tag=隐藏所有赚金币项目,desc=
hideInteraction=switch,true,tag=屏蔽评论区顶部书友互动榜头像人数,desc=
hideMessage=switch,true,tag=屏蔽我的-消息通知红点提示,desc=
searchOption=select,"推荐","默认","空白",tag=搜索框填充词显示,desc=
userID=input,"输入自己的账号ID启用详情页伪装",tag=账号ID,desc=
nickname=input,"",tag=用户昵称(为空不修改),desc=
avatarbox=input,"https://cdn.wtzw.com/bookimg/free/png/17198299375688291.png",tag=头像框链接,desc=

[Rewrite]
^https:\/\/api-gw\.wtzw\.com\/mc\/h5\/materials reject
^https:\/\/api-gw\.wtzw\.com\/legacy\/api\/v1\/user\/red-point reject
^https:\/\/api-cmnt\.wtzw\.com\/api\/v1\/comment\/book-(evaluates|discussion)\? response-body-json-del data.activity
^https:\/\/api-bc\.wtzw\.com\/api\/v(1\/(leader-board|must-read-more|(secondary-)?book-store(\/rank-tag)?)|5\/(category\/get-list|book-store\/recommend)|6\/book-store\/(recommend|tag)|[47]\/book-store) response-body-json-jq jq-path="https://raw.githubusercontent.com/Nathalie-Annis/Loon/refs/heads/main/jq/qimao_tag.jq"
^https:\/\/xiaoshuo\.wtzw\.com\/api\/v2\/init response-body-json-del data.main_activities data.teenager_mode data.push_permission_pop data.guide_login_sub_title data.guide_login_icon_url data.red_packet_pop
^https:\/\/xiaoshuo\.wtzw\.com\/api\/v1\/follow\/friend-list response-body-json-replace data.total_fans_num "9999999"

[Script]
http-response ^https:\/\/xiaoshuo\.wtzw\.com\/api\/v1\/sign-in\/sign-in-banner script-path=https://raw.githubusercontent.com/Nathalie-Annis/Loon/refs/heads/main/Script/qimao_coin_banner.js, requires-body=true, tag=屏蔽书架上方金币签到, enable={hideCoin}
http-response ^https:\/\/api-cmnt\.wtzw\.com\/api\/(v1\/paragraph\/list|v2\/(paragraph|chapter-comment)\/first) script-path=https://raw.githubusercontent.com/Nathalie-Annis/Loon/refs/heads/main/Script/qimao_interaction.js, requires-body=true, tag=精简评论区, argument=[{hideInteraction}]
http-response ^https:\/\/api-bc\.wtzw\.com\/api\/v4\/search\/dispose script-path=https://raw.githubusercontent.com/Nathalie-Annis/Loon/refs/heads/main/Script/qimao_search.js, tag=去除搜索框填充词, argument=[{searchOption}]
http-response ^https:\/\/api-bc\.wtzw\.com\/api\/v5\/search\/hot-word script-path=https://raw.githubusercontent.com/Nathalie-Annis/Loon/refs/heads/main/Script/qimao_search2.js, requires-body=true, tag=去除搜索详情页填充词, argument=[{searchOption}]
http-response ^https:\/\/xiaoshuo\.wtzw\.com\/api\/v3\/user\/my-center script-path=https://raw.githubusercontent.com/Nathalie-Annis/Loon/refs/heads/main/Script/qimao_fake.js, requires-body=true, tag=精简&伪装我的页面, argument=[{hideCoin},{hideMessage},{nickname},{avatarbox}]
http-response ^https:\/\/xiaoshuo\.wtzw\.com\/api\/v1\/user\/page\?book_id=&sign= script-path=https://raw.githubusercontent.com/Nathalie-Annis/Loon/refs/heads/main/Script/qimao_fake2.js, requires-body=true, tag=伪装用户详情页面, argument=[{userID},{nickname},{avatarbox}]

[MITM]
hostname = api-gw.wtzw.com,api-bc.wtzw.com,api-cmnt.wtzw.com,xiaoshuo.wtzw.com